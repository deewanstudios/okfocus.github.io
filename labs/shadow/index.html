<!doctype html>
<html>
<head>
<title>Drop Shadow Parallax</title>
<style type="text/css">
body {
  overflow: hidden;
}
div {
  position: absolute;
  display: block;
}
#sun {
  position: absolute;
  display: block;
  top: 50%;
  left: 50%;
  width: 1px;
  height: 1px;
  box-shadow: 0 0 10px #ff0, 0 0 10px #ff0, 0 0 10px #ff0;
}
</style>
</head>
<body>
<span id="sun"></span>
</body>
<script type="text/javascript">
var colors = "#444 #555 #666 #777 #888 #999 #aaa #bbb #ccc #ddd".split(" ");
function choice (list) { return list[Math.floor(Math.random() * colors.length)]; }
var divs = [];
var make_divs = function () {
  var w = window.screen.availWidth;
  var h = window.screen.availHeight;
  var dw = w / 40;
  var dh = h / 20;
  var frag = document.createDocumentFragment();
  var border = true;
  for (var i = 0; i < 20; i++) {
    var div = document.createElement("div");
    var t = Math.floor(Math.random() * h);
    var left = Math.floor(Math.random() * w);
    var width = Math.floor((0.5 + Math.random()) * dw);
    var height = Math.floor((0.5 + Math.random()) * dh);
    div.style.width = width + "px";
    div.style.height = height + "px";
    div.style.left = left + "px";
    div.style.top = t + "px";
    div.style.backgroundColor = choice(colors);
    divs.push([left, t, width, height, div])
    if (border) {
      div.style.border = "1px solid #f00";
      border = false;
    }
    frag.appendChild(div);
  }
  document.body.appendChild(frag);
}
var sun = document.getElementById('sun');
make_divs();
window.onmousemove = function (e) {
  var x = e.pageX;
  var y = e.pageY;
  sun.style.top = y + "px";
  sun.style.left = x + "px";
  for (var i = 0, len = divs.length; i < len; i++) {
    var row = divs[i];
    var cy = row[1] + row[3]/2;
    var cx = row[0] + row[2] / 2;
    var dx = (cx - x)
    var dy = (cy - y)
    var sx = (cx - x) / 30;
    var sy = (cy - y) / 30;
    var distance = Math.sqrt(dx*dx + dy*dy)
    console.log(sx, sy, distance);
    var fuzz = distance / 40;
    row[4].style.boxShadow = sx + "px " + sy + "px " + fuzz + "px #888";
  }
}

</script>
</html>

